# ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ë°ëª¨ í˜ì´ì§€ ì„¤ê³„ ëª…ì„¸ì„œ

## ğŸ“‹ ê°œìš”

### ëª©ì 
ìš©ì–´ ì¶”ì¶œ ë° ì›¹ ê°•í™” ê²°ê³¼ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ í‘œì‹œí•˜ëŠ” ë°ëª¨ í˜ì´ì§€ ì„¤ê³„

### ì£¼ìš” ê¸°ëŠ¥
1. JSON ë°ì´í„° ì…ë ¥ (textarea ë˜ëŠ” íŒŒì¼ ì—…ë¡œë“œ)
2. ë‹¤êµ­ì–´ ë²ˆì—­ ì»¬ëŸ¼ ì„ íƒ (11ê°œ ì–¸ì–´ ì¤‘ ìµœëŒ€ 11ê°œ ì„ íƒ)
3. ì„œë²„ APIë¥¼ í†µí•œ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„±
4. ìƒì„±ëœ ë§ˆí¬ë‹¤ìš´ í‘œì‹œ ë° ë‹¤ìš´ë¡œë“œ

### ê¸°ìˆ  ìŠ¤íƒ
- **Frontend**: HTML5, CSS3, JavaScript (Vanilla)
- **Backend**: FastAPI, Python 3.11+
- **Data Format**: JSON (ì…ë ¥), Markdown (ì¶œë ¥)

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Frontend (HTML/JS)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Input Section                           â”‚   â”‚
â”‚  â”‚  - JSON textarea / File upload           â”‚   â”‚
â”‚  â”‚  - Sample data load button               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Language Options Section                â”‚   â”‚
â”‚  â”‚  - 11 language checkboxes (3 columns)    â”‚   â”‚
â”‚  â”‚  - All/None selection buttons            â”‚   â”‚
â”‚  â”‚  - Default: ko + en selected             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Output Section                          â”‚   â”‚
â”‚  â”‚  - Markdown table textarea (read-only)   â”‚   â”‚
â”‚  â”‚  - Copy to clipboard button              â”‚   â”‚
â”‚  â”‚  - Download .md file button              â”‚   â”‚
â”‚  â”‚  - Statistics (term count, column count) â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“ POST /api/v1/markdown/generate
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Backend API (FastAPI)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Presentation Layer                      â”‚   â”‚
â”‚  â”‚  - MarkdownRouter                        â”‚   â”‚
â”‚  â”‚  - Request validation                    â”‚   â”‚
â”‚  â”‚  - Response serialization                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Application Layer                       â”‚   â”‚
â”‚  â”‚  - MarkdownGenerationService             â”‚   â”‚
â”‚  â”‚  - DTO: Request/Response                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Domain Layer                            â”‚   â”‚
â”‚  â”‚  - MarkdownTableFormatter                â”‚   â”‚
â”‚  â”‚  - Language validation logic             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° í”Œë¡œìš°

```
1. User Input
   â†“
2. Frontend validates JSON + selected languages
   â†“
3. POST /api/v1/markdown/generate
   {
     "terms_data": { enhanced_terms: [...] },
     "selected_languages": ["ko", "en", ...]
   }
   â†“
4. Backend processes request
   - Parse JSON
   - Validate languages
   - Generate markdown table
   â†“
5. Return response
   {
     "markdown_table": "| term | ... |",
     "term_count": 50,
     "column_count": 5
   }
   â†“
6. Frontend displays markdown in textarea
```

---

## ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ ì„¤ê³„

### í˜ì´ì§€ ë ˆì´ì•„ì›ƒ

```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <title>ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ë°ëª¨</title>
</head>
<body>
    <!-- Header Section -->
    <header>
        <h1>ğŸ“Š ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ë°ëª¨</h1>
        <p>ìš©ì–´ ì¶”ì¶œ ê²°ê³¼ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ë³€í™˜í•©ë‹ˆë‹¤</p>
    </header>

    <!-- Input Section -->
    <section id="input-section">
        <h2>1. JSON ë°ì´í„° ì…ë ¥</h2>
        <textarea id="json-input" rows="10"></textarea>
        <div class="buttons">
            <button id="load-sample">ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ</button>
            <button id="upload-file">íŒŒì¼ ì—…ë¡œë“œ</button>
        </div>
    </section>

    <!-- Language Options Section -->
    <section id="language-options">
        <h2>2. ë²ˆì—­ ì–¸ì–´ ì„ íƒ (ìµœëŒ€ 11ê°œ)</h2>
        <div class="selection-buttons">
            <button id="select-all">ì „ì²´ ì„ íƒ</button>
            <button id="select-none">ì„ íƒ í•´ì œ</button>
        </div>
        <div class="language-grid">
            <!-- 3 columns x 4 rows -->
            <label><input type="checkbox" value="ko" checked> í•œêµ­ì–´ (ko)</label>
            <label><input type="checkbox" value="en" checked> English (en)</label>
            <label><input type="checkbox" value="zh-CN"> ç®€ä½“ä¸­æ–‡ (zh-CN)</label>
            <label><input type="checkbox" value="zh-TW"> ç¹é«”ä¸­æ–‡ (zh-TW)</label>
            <label><input type="checkbox" value="ja"> æ—¥æœ¬èª (ja)</label>
            <label><input type="checkbox" value="fr"> FranÃ§ais (fr)</label>
            <label><input type="checkbox" value="ru"> Ğ ÑƒÑÑĞºĞ¸Ğ¹ (ru)</label>
            <label><input type="checkbox" value="it"> Italiano (it)</label>
            <label><input type="checkbox" value="vi"> Tiáº¿ng Viá»‡t (vi)</label>
            <label><input type="checkbox" value="ar"> Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (ar)</label>
            <label><input type="checkbox" value="es"> EspaÃ±ol (es)</label>
        </div>
    </section>

    <!-- Submit Section -->
    <section id="submit-section">
        <button id="generate-btn" class="primary-btn">
            ğŸš€ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„±
        </button>
    </section>

    <!-- Output Section -->
    <section id="output-section">
        <h2>3. ìƒì„±ëœ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”</h2>
        <textarea id="markdown-output" rows="20" readonly></textarea>
        <div class="output-buttons">
            <button id="copy-btn">ğŸ“‹ í´ë¦½ë³´ë“œì— ë³µì‚¬</button>
            <button id="download-btn">ğŸ’¾ .md íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
        </div>
        <div class="statistics">
            <span>ìš©ì–´ ê°œìˆ˜: <strong id="term-count">0</strong></span>
            <span>ì»¬ëŸ¼ ê°œìˆ˜: <strong id="column-count">0</strong></span>
        </div>
    </section>
</body>
</html>
```

### CSS ìŠ¤íƒ€ì¼ ê°€ì´ë“œ

```css
/* ì£¼ìš” ìŠ¤íƒ€ì¼ ì»´í¬ë„ŒíŠ¸ */
:root {
    --primary-color: #4A90E2;
    --success-color: #28A745;
    --bg-light: #F8F9FA;
    --border-color: #DEE2E6;
    --text-dark: #212529;
}

/* ë ˆì´ì•„ì›ƒ */
body {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

section {
    margin-bottom: 30px;
    padding: 20px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* ì…ë ¥ í•„ë“œ */
textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    resize: vertical;
}

/* ì–¸ì–´ ì„ íƒ ê·¸ë¦¬ë“œ */
.language-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    margin-top: 15px;
}

.language-grid label {
    padding: 8px 12px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s;
}

.language-grid label:hover {
    background: var(--bg-light);
    border-color: var(--primary-color);
}

/* ë²„íŠ¼ */
button {
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s;
}

.primary-btn {
    background: var(--primary-color);
    color: white;
    font-size: 16px;
    padding: 12px 30px;
}

.primary-btn:hover {
    background: #357ABD;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}
```

### JavaScript ë¡œì§

```javascript
// ì£¼ìš” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
document.addEventListener('DOMContentLoaded', () => {
    // ìƒ˜í”Œ ë°ì´í„° ë¡œë“œ
    document.getElementById('load-sample').addEventListener('click', loadSampleData);

    // ì „ì²´ ì„ íƒ/í•´ì œ
    document.getElementById('select-all').addEventListener('click', selectAllLanguages);
    document.getElementById('select-none').addEventListener('click', deselectAllLanguages);

    // ë§ˆí¬ë‹¤ìš´ ìƒì„±
    document.getElementById('generate-btn').addEventListener('click', generateMarkdown);

    // í´ë¦½ë³´ë“œ ë³µì‚¬
    document.getElementById('copy-btn').addEventListener('click', copyToClipboard);

    // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
    document.getElementById('download-btn').addEventListener('click', downloadMarkdown);
});

// ë§ˆí¬ë‹¤ìš´ ìƒì„± API í˜¸ì¶œ
async function generateMarkdown() {
    try {
        // ì…ë ¥ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const jsonInput = document.getElementById('json-input').value;
        const termsData = JSON.parse(jsonInput);

        // ì„ íƒëœ ì–¸ì–´ ê°€ì ¸ì˜¤ê¸°
        const selectedLanguages = Array.from(
            document.querySelectorAll('.language-grid input:checked')
        ).map(cb => cb.value);

        // ìœ íš¨ì„± ê²€ì¦
        if (selectedLanguages.length === 0) {
            alert('ìµœì†Œ 1ê°œ ì´ìƒì˜ ì–¸ì–´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”');
            return;
        }

        if (selectedLanguages.length > 11) {
            alert('ìµœëŒ€ 11ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤');
            return;
        }

        // API ìš”ì²­
        const response = await fetch('/api/v1/markdown/generate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                terms_data: termsData,
                selected_languages: selectedLanguages
            })
        });

        if (!response.ok) {
            throw new Error(`API ì˜¤ë¥˜: ${response.status}`);
        }

        // ì‘ë‹µ ì²˜ë¦¬
        const result = await response.json();

        // ë§ˆí¬ë‹¤ìš´ í‘œì‹œ
        document.getElementById('markdown-output').value = result.markdown_table;

        // í†µê³„ ì—…ë°ì´íŠ¸
        document.getElementById('term-count').textContent = result.term_count;
        document.getElementById('column-count').textContent = result.column_count;

        // ì„±ê³µ ë©”ì‹œì§€
        alert('âœ… ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ì™„ë£Œ!');

    } catch (error) {
        console.error('ë§ˆí¬ë‹¤ìš´ ìƒì„± ì‹¤íŒ¨:', error);
        alert(`âŒ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`);
    }
}

// í´ë¦½ë³´ë“œ ë³µì‚¬
async function copyToClipboard() {
    const markdown = document.getElementById('markdown-output').value;
    if (!markdown) {
        alert('ìƒì„±ëœ ë§ˆí¬ë‹¤ìš´ì´ ì—†ìŠµë‹ˆë‹¤');
        return;
    }

    try {
        await navigator.clipboard.writeText(markdown);
        alert('âœ… í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤');
    } catch (error) {
        alert('âŒ ë³µì‚¬ ì‹¤íŒ¨: ' + error.message);
    }
}

// íŒŒì¼ ë‹¤ìš´ë¡œë“œ
function downloadMarkdown() {
    const markdown = document.getElementById('markdown-output').value;
    if (!markdown) {
        alert('ìƒì„±ëœ ë§ˆí¬ë‹¤ìš´ì´ ì—†ìŠµë‹ˆë‹¤');
        return;
    }

    const blob = new Blob([markdown], { type: 'text/markdown' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `terms-table-${new Date().toISOString().slice(0,10)}.md`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}
```

---

## ğŸ”§ ë°±ì—”ë“œ API ì„¤ê³„

### 1. API ì—”ë“œí¬ì¸íŠ¸

#### POST /api/v1/markdown/generate

**ì„¤ëª…**: JSON ìš©ì–´ ë°ì´í„°ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ë³€í™˜

**Request Body**:
```json
{
    "terms_data": {
        "enhanced_terms": [
            {
                "original_term": "Naciones Unidas",
                "term_type": "company",
                "primary_domain": "international relations",
                "context": "International organization",
                "tags": ["#ONU", "#global", "#politics"],
                "translations": {
                    "ko": "ìœ ì—”",
                    "en": "United Nations",
                    "zh-CN": "è”åˆå›½",
                    "zh-TW": "è¯åˆåœ‹",
                    "ja": "å›½éš›é€£åˆ",
                    "fr": "Nations Unies",
                    "ru": "ĞÑ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ĞĞ±ÑŠĞµĞ´Ğ¸Ğ½Ñ‘Ğ½Ğ½Ñ‹Ñ… ĞĞ°Ñ†Ğ¸Ğ¹",
                    "it": "Nazioni Unite",
                    "vi": "LiÃªn Há»£p Quá»‘c",
                    "ar": "Ø§Ù„Ø£Ù…Ù… Ø§Ù„Ù…ØªØ­Ø¯Ø©",
                    "es": "Naciones Unidas"
                },
                "web_sources": ["https://www.un.org/"],
                "source": "gpt4o_web",
                "confidence_score": 0.98,
                "search_timestamp": "2025-10-13T13:21:05.504783"
            }
        ]
    },
    "selected_languages": ["ko", "en", "ja"]
}
```

**Response**:
```json
{
    "markdown_table": "| term | term_type | tags | ko | en | ja |\n|------|----------|------|----|----|----|\n| Naciones Unidas | company | #ONU #global #politics | ìœ ì—” | United Nations | å›½éš›é€£åˆ |",
    "term_count": 1,
    "column_count": 6
}
```

**Status Codes**:
- `200 OK`: ì„±ê³µì ìœ¼ë¡œ ë§ˆí¬ë‹¤ìš´ ìƒì„±
- `400 Bad Request`: ì˜ëª»ëœ ì…ë ¥ ë°ì´í„°
- `422 Unprocessable Entity`: ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨
- `500 Internal Server Error`: ì„œë²„ ì˜¤ë¥˜

### 2. ë¼ìš°í„° êµ¬í˜„

**íŒŒì¼**: `src/presentation/api/routes/markdown.py`

```python
"""
ë§ˆí¬ë‹¤ìš´ ìƒì„± API ë¼ìš°í„°

JSON ìš©ì–´ ë°ì´í„°ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ë³€í™˜í•˜ëŠ” APIë¥¼ ì œê³µí•©ë‹ˆë‹¤.
"""

from fastapi import APIRouter, Depends, HTTPException, status
from typing import Annotated

from src.application.markdown.dto.markdown_request_dto import MarkdownGenerationRequest
from src.application.markdown.dto.markdown_response_dto import MarkdownGenerationResponse
from src.application.markdown.services.markdown_generation_service import MarkdownGenerationService
from src.infrastructure.web.dependencies import get_markdown_service

# ë¼ìš°í„° ìƒì„±
router = APIRouter(
    prefix="/api/v1/markdown",
    tags=["markdown"]
)


@router.post(
    "/generate",
    response_model=MarkdownGenerationResponse,
    status_code=status.HTTP_200_OK,
    summary="ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„±",
    description="""
    JSON ìš©ì–´ ë°ì´í„°ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

    **ì…ë ¥ ë°ì´í„° êµ¬ì¡°:**
    - terms_data: enhanced_terms ë°°ì—´ì„ í¬í•¨í•˜ëŠ” JSON ê°ì²´
    - selected_languages: ì„ íƒëœ ì–¸ì–´ ì½”ë“œ ë°°ì—´ (1-11ê°œ)

    **ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í˜•ì‹:**
    - ì»¬ëŸ¼: term | term_type | tags | [ì„ íƒëœ ì–¸ì–´ë³„ ë²ˆì—­]
    - íƒ€ì´íŠ¸í•œ ìŠ¤í˜ì´ì‹±ìœ¼ë¡œ ì»´íŒ©íŠ¸í•˜ê²Œ ìƒì„±
    - tagsëŠ” ê³µë°±ìœ¼ë¡œ êµ¬ë¶„ëœ ë¬¸ìì—´ (#tag1 #tag2)

    **ì§€ì› ì–¸ì–´ ì½”ë“œ:**
    - ko, en, zh-CN, zh-TW, ja, fr, ru, it, vi, ar, es
    """,
    responses={
        200: {
            "description": "ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ì„±ê³µ",
            "content": {
                "application/json": {
                    "example": {
                        "markdown_table": "| term | term_type | tags | ko | en |\n|------|----------|------|----|----|",
                        "term_count": 50,
                        "column_count": 5
                    }
                }
            }
        },
        400: {
            "description": "ì˜ëª»ëœ ì…ë ¥ ë°ì´í„°",
            "content": {
                "application/json": {
                    "example": {
                        "detail": "terms_dataì— enhanced_terms ë°°ì—´ì´ ì—†ìŠµë‹ˆë‹¤"
                    }
                }
            }
        },
        422: {
            "description": "ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨",
            "content": {
                "application/json": {
                    "example": {
                        "detail": "ì„ íƒëœ ì–¸ì–´ê°€ ìµœëŒ€ 11ê°œë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤"
                    }
                }
            }
        }
    }
)
async def generate_markdown_table(
    request: MarkdownGenerationRequest,
    service: Annotated[MarkdownGenerationService, Depends(get_markdown_service)]
) -> MarkdownGenerationResponse:
    """
    JSON ìš©ì–´ ë°ì´í„°ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

    Args:
        request: ë§ˆí¬ë‹¤ìš´ ìƒì„± ìš”ì²­ DTO
        service: ë§ˆí¬ë‹¤ìš´ ìƒì„± ì„œë¹„ìŠ¤ (DI)

    Returns:
        MarkdownGenerationResponse: ìƒì„±ëœ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ë° ë©”íƒ€ë°ì´í„°

    Raises:
        HTTPException: ì…ë ¥ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨ ë˜ëŠ” ì„œë²„ ì˜¤ë¥˜
    """
    try:
        # ì„œë¹„ìŠ¤ í˜¸ì¶œí•˜ì—¬ ë§ˆí¬ë‹¤ìš´ ìƒì„±
        response = await service.generate_markdown_table(request)
        return response

    except ValueError as e:
        # ì…ë ¥ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail=str(e)
        )
    except Exception as e:
        # ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail=f"ë§ˆí¬ë‹¤ìš´ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}"
        )
```

### 3. DTO í´ë˜ìŠ¤

#### MarkdownGenerationRequest

**íŒŒì¼**: `src/application/markdown/dto/markdown_request_dto.py`

```python
"""
ë§ˆí¬ë‹¤ìš´ ìƒì„± ìš”ì²­ DTO

API ìš”ì²­ ë°ì´í„°ë¥¼ ê²€ì¦í•˜ê³  ë³€í™˜í•©ë‹ˆë‹¤.
"""

from pydantic import BaseModel, Field, field_validator
from typing import Dict, List, Any


class MarkdownGenerationRequest(BaseModel):
    """
    ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ìš”ì²­ DTO

    Attributes:
        terms_data: enhanced_terms ë°°ì—´ì„ í¬í•¨í•˜ëŠ” JSON ë°ì´í„°
        selected_languages: ì„ íƒëœ ì–¸ì–´ ì½”ë“œ ë¦¬ìŠ¤íŠ¸ (1-11ê°œ)
    """

    terms_data: Dict[str, Any] = Field(
        ...,
        description="ìš©ì–´ ë°ì´í„° JSON (enhanced_terms ë°°ì—´ í¬í•¨)",
        example={
            "enhanced_terms": [
                {
                    "original_term": "Naciones Unidas",
                    "term_type": "company",
                    "tags": ["#ONU", "#global"],
                    "translations": {
                        "ko": "ìœ ì—”",
                        "en": "United Nations"
                    }
                }
            ]
        }
    )

    selected_languages: List[str] = Field(
        ...,
        min_length=1,
        max_length=11,
        description="ì„ íƒëœ ì–¸ì–´ ì½”ë“œ ë¦¬ìŠ¤íŠ¸",
        example=["ko", "en", "ja"]
    )

    @field_validator("terms_data")
    @classmethod
    def validate_terms_data(cls, v: Dict[str, Any]) -> Dict[str, Any]:
        """
        terms_data ìœ íš¨ì„± ê²€ì¦

        Args:
            v: terms_data ë”•ì…”ë„ˆë¦¬

        Returns:
            ê²€ì¦ëœ terms_data

        Raises:
            ValueError: enhanced_terms ë°°ì—´ì´ ì—†ê±°ë‚˜ ë¹„ì–´ìˆëŠ” ê²½ìš°
        """
        if "enhanced_terms" not in v:
            raise ValueError("terms_dataì— enhanced_terms ë°°ì—´ì´ ì—†ìŠµë‹ˆë‹¤")

        if not isinstance(v["enhanced_terms"], list):
            raise ValueError("enhanced_termsëŠ” ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤")

        if len(v["enhanced_terms"]) == 0:
            raise ValueError("enhanced_terms ë°°ì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤")

        return v

    @field_validator("selected_languages")
    @classmethod
    def validate_languages(cls, v: List[str]) -> List[str]:
        """
        ì„ íƒëœ ì–¸ì–´ ì½”ë“œ ìœ íš¨ì„± ê²€ì¦

        Args:
            v: ì–¸ì–´ ì½”ë“œ ë¦¬ìŠ¤íŠ¸

        Returns:
            ê²€ì¦ëœ ì–¸ì–´ ì½”ë“œ ë¦¬ìŠ¤íŠ¸

        Raises:
            ValueError: ìœ íš¨í•˜ì§€ ì•Šì€ ì–¸ì–´ ì½”ë“œ í¬í•¨ ì‹œ
        """
        VALID_LANGUAGES = {
            "ko", "en", "zh-CN", "zh-TW", "ja",
            "fr", "ru", "it", "vi", "ar", "es"
        }

        # ì¤‘ë³µ ì œê±°
        unique_languages = list(dict.fromkeys(v))

        # ìœ íš¨ì„± ê²€ì¦
        invalid = set(unique_languages) - VALID_LANGUAGES
        if invalid:
            raise ValueError(
                f"ìœ íš¨í•˜ì§€ ì•Šì€ ì–¸ì–´ ì½”ë“œ: {', '.join(invalid)}"
            )

        return unique_languages

    class Config:
        json_schema_extra = {
            "example": {
                "terms_data": {
                    "enhanced_terms": [
                        {
                            "original_term": "Naciones Unidas",
                            "term_type": "company",
                            "tags": ["#ONU", "#global", "#politics"],
                            "translations": {
                                "ko": "ìœ ì—”",
                                "en": "United Nations",
                                "ja": "å›½éš›é€£åˆ"
                            }
                        }
                    ]
                },
                "selected_languages": ["ko", "en", "ja"]
            }
        }
```

#### MarkdownGenerationResponse

**íŒŒì¼**: `src/application/markdown/dto/markdown_response_dto.py`

```python
"""
ë§ˆí¬ë‹¤ìš´ ìƒì„± ì‘ë‹µ DTO

API ì‘ë‹µ ë°ì´í„° êµ¬ì¡°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
"""

from pydantic import BaseModel, Field


class MarkdownGenerationResponse(BaseModel):
    """
    ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ì‘ë‹µ DTO

    Attributes:
        markdown_table: ìƒì„±ëœ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ë¬¸ìì—´
        term_count: ìš©ì–´ ê°œìˆ˜
        column_count: ì»¬ëŸ¼ ê°œìˆ˜ (term, term_type, tags + ì„ íƒëœ ì–¸ì–´ ìˆ˜)
    """

    markdown_table: str = Field(
        ...,
        description="ìƒì„±ëœ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ë¬¸ìì—´",
        example="| term | term_type | tags | ko | en |\n|------|----------|------|----|----|"
    )

    term_count: int = Field(
        ...,
        ge=0,
        description="ìš©ì–´ ê°œìˆ˜",
        example=50
    )

    column_count: int = Field(
        ...,
        ge=4,  # ìµœì†Œ: term, term_type, tags + 1ê°œ ì–¸ì–´
        le=14,  # ìµœëŒ€: term, term_type, tags + 11ê°œ ì–¸ì–´
        description="ì»¬ëŸ¼ ê°œìˆ˜",
        example=5
    )

    class Config:
        json_schema_extra = {
            "example": {
                "markdown_table": "| term | term_type | tags | ko | en |\n|------|----------|------|----|----|----|\n| Naciones Unidas | company | #ONU #global | ìœ ì—” | United Nations |",
                "term_count": 1,
                "column_count": 5
            }
        }
```

### 4. ì„œë¹„ìŠ¤ ë ˆì´ì–´

#### MarkdownGenerationService

**íŒŒì¼**: `src/application/markdown/services/markdown_generation_service.py`

```python
"""
ë§ˆí¬ë‹¤ìš´ ìƒì„± ì„œë¹„ìŠ¤

ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ê³  ë„ë©”ì¸ ë ˆì´ì–´ì™€ í†µì‹ í•©ë‹ˆë‹¤.
"""

from typing import List, Dict, Any

from src.application.markdown.dto.markdown_request_dto import MarkdownGenerationRequest
from src.application.markdown.dto.markdown_response_dto import MarkdownGenerationResponse
from src.domain.markdown.services.markdown_table_formatter import MarkdownTableFormatter


class MarkdownGenerationService:
    """
    ë§ˆí¬ë‹¤ìš´ ìƒì„± ì„œë¹„ìŠ¤

    ìš©ì–´ ë°ì´í„°ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ë³€í™˜í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.
    """

    def __init__(self, formatter: MarkdownTableFormatter):
        """
        ì„œë¹„ìŠ¤ ì´ˆê¸°í™”

        Args:
            formatter: ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í¬ë§¤í„° (ë„ë©”ì¸ ì„œë¹„ìŠ¤)
        """
        self._formatter = formatter

    async def generate_markdown_table(
        self,
        request: MarkdownGenerationRequest
    ) -> MarkdownGenerationResponse:
        """
        JSON ìš©ì–´ ë°ì´í„°ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

        Args:
            request: ë§ˆí¬ë‹¤ìš´ ìƒì„± ìš”ì²­ DTO

        Returns:
            MarkdownGenerationResponse: ìƒì„±ëœ ë§ˆí¬ë‹¤ìš´ ë° ë©”íƒ€ë°ì´í„°

        Raises:
            ValueError: ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨
        """
        # enhanced_terms ë°°ì—´ ì¶”ì¶œ
        enhanced_terms = request.terms_data.get("enhanced_terms", [])

        # ìš©ì–´ ë°ì´í„° ê²€ì¦
        self._validate_terms(enhanced_terms, request.selected_languages)

        # ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„±
        markdown_table = self._formatter.format_table(
            terms=enhanced_terms,
            languages=request.selected_languages
        )

        # ì‘ë‹µ ìƒì„±
        return MarkdownGenerationResponse(
            markdown_table=markdown_table,
            term_count=len(enhanced_terms),
            column_count=3 + len(request.selected_languages)  # term + term_type + tags + languages
        )

    def _validate_terms(
        self,
        terms: List[Dict[str, Any]],
        languages: List[str]
    ) -> None:
        """
        ìš©ì–´ ë°ì´í„° ìœ íš¨ì„± ê²€ì¦

        Args:
            terms: ìš©ì–´ ë°ì´í„° ë¦¬ìŠ¤íŠ¸
            languages: ì„ íƒëœ ì–¸ì–´ ì½”ë“œ ë¦¬ìŠ¤íŠ¸

        Raises:
            ValueError: í•„ìˆ˜ í•„ë“œ ëˆ„ë½ ë˜ëŠ” ë²ˆì—­ ë°ì´í„° ë¶€ì¡±
        """
        for idx, term in enumerate(terms):
            # í•„ìˆ˜ í•„ë“œ í™•ì¸
            required_fields = ["original_term", "term_type", "tags", "translations"]
            missing = [f for f in required_fields if f not in term]

            if missing:
                raise ValueError(
                    f"ìš©ì–´ {idx}ì— í•„ìˆ˜ í•„ë“œ ëˆ„ë½: {', '.join(missing)}"
                )

            # ë²ˆì—­ ë°ì´í„° í™•ì¸
            translations = term.get("translations", {})
            missing_langs = [lang for lang in languages if lang not in translations]

            if missing_langs:
                raise ValueError(
                    f"ìš©ì–´ '{term['original_term']}'ì— ë²ˆì—­ ëˆ„ë½: {', '.join(missing_langs)}"
                )
```

### 5. ë„ë©”ì¸ ì„œë¹„ìŠ¤

#### MarkdownTableFormatter

**íŒŒì¼**: `src/domain/markdown/services/markdown_table_formatter.py`

```python
"""
ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í¬ë§¤í„°

ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ë° í¬ë§·íŒ… ë¡œì§ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.
"""

from typing import List, Dict, Any


class MarkdownTableFormatter:
    """
    ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í¬ë§¤í„°

    ìš©ì–´ ë°ì´í„°ë¥¼ ì»´íŒ©íŠ¸í•œ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
    """

    def format_table(
        self,
        terms: List[Dict[str, Any]],
        languages: List[str]
    ) -> str:
        """
        ìš©ì–´ ë°ì´í„°ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ í¬ë§·íŒ…í•©ë‹ˆë‹¤.

        Args:
            terms: ìš©ì–´ ë°ì´í„° ë¦¬ìŠ¤íŠ¸
            languages: ì„ íƒëœ ì–¸ì–´ ì½”ë“œ ë¦¬ìŠ¤íŠ¸

        Returns:
            í¬ë§·íŒ…ëœ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ë¬¸ìì—´
        """
        # í…Œì´ë¸” í—¤ë” ìƒì„±
        header = self._format_header(languages)

        # êµ¬ë¶„ì„  ìƒì„±
        separator = self._format_separator(len(languages))

        # ë°ì´í„° í–‰ ìƒì„±
        rows = [
            self._format_row(term, languages)
            for term in terms
        ]

        # í…Œì´ë¸” ì¡°ë¦½ (íƒ€ì´íŠ¸í•œ ìŠ¤í˜ì´ì‹±)
        table_lines = [header, separator] + rows
        return "\n".join(table_lines)

    def _format_header(self, languages: List[str]) -> str:
        """
        í…Œì´ë¸” í—¤ë” ìƒì„±

        Args:
            languages: ì–¸ì–´ ì½”ë“œ ë¦¬ìŠ¤íŠ¸

        Returns:
            í—¤ë” ë¬¸ìì—´ (ì˜ˆ: "| term | term_type | tags | ko | en |")
        """
        # ê¸°ë³¸ ì»¬ëŸ¼: term, term_type, tags
        columns = ["term", "term_type", "tags"] + languages

        # ì»´íŒ©íŠ¸ í¬ë§·: ê³µë°± ìµœì†Œí™”
        return "|" + "|".join(columns) + "|"

    def _format_separator(self, language_count: int) -> str:
        """
        í…Œì´ë¸” êµ¬ë¶„ì„  ìƒì„±

        Args:
            language_count: ì–¸ì–´ ê°œìˆ˜

        Returns:
            êµ¬ë¶„ì„  ë¬¸ìì—´ (ì˜ˆ: "|------|----------|------|----|----|")
        """
        # ê¸°ë³¸ ì»¬ëŸ¼ êµ¬ë¶„ì„ 
        base_separators = ["------", "----------", "------"]  # term, term_type, tags

        # ì–¸ì–´ ì»¬ëŸ¼ êµ¬ë¶„ì„ 
        lang_separators = ["-----"] * language_count

        # ì¡°ë¦½
        return "|" + "|".join(base_separators + lang_separators) + "|"

    def _format_row(
        self,
        term: Dict[str, Any],
        languages: List[str]
    ) -> str:
        """
        ë°ì´í„° í–‰ í¬ë§·íŒ…

        Args:
            term: ìš©ì–´ ë°ì´í„°
            languages: ì–¸ì–´ ì½”ë“œ ë¦¬ìŠ¤íŠ¸

        Returns:
            ë°ì´í„° í–‰ ë¬¸ìì—´
        """
        # ê¸°ë³¸ í•„ë“œ
        original_term = term.get("original_term", "")
        term_type = term.get("term_type", "")

        # Tags í¬ë§·íŒ… (ë°°ì—´ â†’ ê³µë°± êµ¬ë¶„ ë¬¸ìì—´)
        tags = self._format_tags(term.get("tags", []))

        # ë²ˆì—­ ë°ì´í„°
        translations = term.get("translations", {})
        translated_values = [
            translations.get(lang, "")
            for lang in languages
        ]

        # í–‰ ì¡°ë¦½
        cells = [original_term, term_type, tags] + translated_values

        # ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ (íŒŒì´í”„ ë¬¸ì)
        escaped_cells = [
            cell.replace("|", "\\|") if isinstance(cell, str) else str(cell)
            for cell in cells
        ]

        return "|" + "|".join(escaped_cells) + "|"

    def _format_tags(self, tags: List[str]) -> str:
        """
        íƒœê·¸ ë°°ì—´ì„ ê³µë°± êµ¬ë¶„ ë¬¸ìì—´ë¡œ ë³€í™˜

        Args:
            tags: íƒœê·¸ ë°°ì—´ (ì˜ˆ: ["#tag1", "#tag2"])

        Returns:
            ê³µë°± êµ¬ë¶„ ë¬¸ìì—´ (ì˜ˆ: "#tag1 #tag2")
        """
        if not tags:
            return ""

        return " ".join(tags)
```

---

## ğŸ“‚ íŒŒì¼ êµ¬ì¡°

```
px-plus/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ presentation/
â”‚   â”‚   â””â”€â”€ api/
â”‚   â”‚       â””â”€â”€ routes/
â”‚   â”‚           â”œâ”€â”€ demo.py (ê¸°ì¡´)
â”‚   â”‚           â””â”€â”€ markdown.py (ì‹ ê·œ - API ë¼ìš°í„°)
â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â””â”€â”€ markdown/ (ì‹ ê·œ)
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ dto/
â”‚   â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚       â”‚   â”œâ”€â”€ markdown_request_dto.py
â”‚   â”‚       â”‚   â””â”€â”€ markdown_response_dto.py
â”‚   â”‚       â””â”€â”€ services/
â”‚   â”‚           â”œâ”€â”€ __init__.py
â”‚   â”‚           â””â”€â”€ markdown_generation_service.py
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â””â”€â”€ markdown/ (ì‹ ê·œ)
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â””â”€â”€ services/
â”‚   â”‚           â”œâ”€â”€ __init__.py
â”‚   â”‚           â””â”€â”€ markdown_table_formatter.py
â”‚   â””â”€â”€ infrastructure/
â”‚       â””â”€â”€ web/
â”‚           â””â”€â”€ dependencies.py (get_markdown_service ì¶”ê°€)
â””â”€â”€ static/
    â””â”€â”€ markdown-table-demo.html (ì‹ ê·œ - í”„ë¡ íŠ¸ì—”ë“œ)
```

---

## ğŸ”— ì˜ì¡´ì„± ì£¼ì…

**íŒŒì¼**: `src/infrastructure/web/dependencies.py`ì— ì¶”ê°€

```python
"""
FastAPI ì˜ì¡´ì„± ì£¼ì… ì„¤ì •
"""

from functools import lru_cache
from src.application.markdown.services.markdown_generation_service import MarkdownGenerationService
from src.domain.markdown.services.markdown_table_formatter import MarkdownTableFormatter


@lru_cache()
def get_markdown_table_formatter() -> MarkdownTableFormatter:
    """
    ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í¬ë§¤í„° ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜

    Returns:
        MarkdownTableFormatter: í¬ë§¤í„° ì¸ìŠ¤í„´ìŠ¤
    """
    return MarkdownTableFormatter()


@lru_cache()
def get_markdown_service() -> MarkdownGenerationService:
    """
    ë§ˆí¬ë‹¤ìš´ ìƒì„± ì„œë¹„ìŠ¤ ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜

    Returns:
        MarkdownGenerationService: ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤
    """
    formatter = get_markdown_table_formatter()
    return MarkdownGenerationService(formatter=formatter)
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

#### 1. MarkdownTableFormatter í…ŒìŠ¤íŠ¸

```python
"""
ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í¬ë§¤í„° ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
"""

import pytest
from src.domain.markdown.services.markdown_table_formatter import MarkdownTableFormatter


class TestMarkdownTableFormatter:
    """
    MarkdownTableFormatter ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
    """

    @pytest.fixture
    def formatter(self):
        """í¬ë§¤í„° ì¸ìŠ¤í„´ìŠ¤"""
        return MarkdownTableFormatter()

    @pytest.fixture
    def sample_terms(self):
        """ìƒ˜í”Œ ìš©ì–´ ë°ì´í„°"""
        return [
            {
                "original_term": "United Nations",
                "term_type": "company",
                "tags": ["#UN", "#global"],
                "translations": {
                    "ko": "ìœ ì—”",
                    "en": "United Nations",
                    "ja": "å›½éš›é€£åˆ"
                }
            },
            {
                "original_term": "NATO",
                "term_type": "company",
                "tags": ["#NATO", "#defense"],
                "translations": {
                    "ko": "ë¶ëŒ€ì„œì–‘ ì¡°ì•½ ê¸°êµ¬",
                    "en": "NATO",
                    "ja": "åŒ—å¤§è¥¿æ´‹æ¡ç´„æ©Ÿæ§‹"
                }
            }
        ]

    def test_format_header(self, formatter):
        """í—¤ë” í¬ë§·íŒ… í…ŒìŠ¤íŠ¸"""
        languages = ["ko", "en", "ja"]
        header = formatter._format_header(languages)

        assert header == "|term|term_type|tags|ko|en|ja|"

    def test_format_separator(self, formatter):
        """êµ¬ë¶„ì„  í¬ë§·íŒ… í…ŒìŠ¤íŠ¸"""
        separator = formatter._format_separator(3)

        assert separator == "|------|----------|------|-----|-----|-----|"

    def test_format_tags(self, formatter):
        """íƒœê·¸ í¬ë§·íŒ… í…ŒìŠ¤íŠ¸"""
        tags = ["#tag1", "#tag2", "#tag3"]
        formatted = formatter._format_tags(tags)

        assert formatted == "#tag1 #tag2 #tag3"

    def test_format_row(self, formatter):
        """í–‰ í¬ë§·íŒ… í…ŒìŠ¤íŠ¸"""
        term = {
            "original_term": "Test Term",
            "term_type": "person",
            "tags": ["#test"],
            "translations": {
                "ko": "í…ŒìŠ¤íŠ¸ ìš©ì–´",
                "en": "Test Term"
            }
        }
        languages = ["ko", "en"]

        row = formatter._format_row(term, languages)

        assert row == "|Test Term|person|#test|í…ŒìŠ¤íŠ¸ ìš©ì–´|Test Term|"

    def test_format_table(self, formatter, sample_terms):
        """ì „ì²´ í…Œì´ë¸” í¬ë§·íŒ… í…ŒìŠ¤íŠ¸"""
        languages = ["ko", "en"]
        table = formatter.format_table(sample_terms, languages)

        lines = table.split("\n")

        # ë¼ì¸ ìˆ˜ í™•ì¸ (í—¤ë” + êµ¬ë¶„ì„  + ë°ì´í„° 2ê°œ)
        assert len(lines) == 4

        # í—¤ë” í™•ì¸
        assert lines[0] == "|term|term_type|tags|ko|en|"

        # êµ¬ë¶„ì„  í™•ì¸
        assert lines[1] == "|------|----------|------|-----|-----|"
```

#### 2. MarkdownGenerationService í…ŒìŠ¤íŠ¸

```python
"""
ë§ˆí¬ë‹¤ìš´ ìƒì„± ì„œë¹„ìŠ¤ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
"""

import pytest
from src.application.markdown.services.markdown_generation_service import MarkdownGenerationService
from src.application.markdown.dto.markdown_request_dto import MarkdownGenerationRequest
from src.domain.markdown.services.markdown_table_formatter import MarkdownTableFormatter


class TestMarkdownGenerationService:
    """
    MarkdownGenerationService ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
    """

    @pytest.fixture
    def service(self):
        """ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤"""
        formatter = MarkdownTableFormatter()
        return MarkdownGenerationService(formatter=formatter)

    @pytest.fixture
    def valid_request(self):
        """ìœ íš¨í•œ ìš”ì²­ ë°ì´í„°"""
        return MarkdownGenerationRequest(
            terms_data={
                "enhanced_terms": [
                    {
                        "original_term": "Test",
                        "term_type": "person",
                        "tags": ["#test"],
                        "translations": {
                            "ko": "í…ŒìŠ¤íŠ¸",
                            "en": "Test"
                        }
                    }
                ]
            },
            selected_languages=["ko", "en"]
        )

    @pytest.mark.asyncio
    async def test_generate_markdown_table_success(self, service, valid_request):
        """ë§ˆí¬ë‹¤ìš´ ìƒì„± ì„±ê³µ í…ŒìŠ¤íŠ¸"""
        response = await service.generate_markdown_table(valid_request)

        assert response.term_count == 1
        assert response.column_count == 5  # term + term_type + tags + ko + en
        assert "|Test|person|#test|í…ŒìŠ¤íŠ¸|Test|" in response.markdown_table

    @pytest.mark.asyncio
    async def test_validate_terms_missing_field(self, service):
        """í•„ìˆ˜ í•„ë“œ ëˆ„ë½ ê²€ì¦ í…ŒìŠ¤íŠ¸"""
        request = MarkdownGenerationRequest(
            terms_data={
                "enhanced_terms": [
                    {
                        "original_term": "Test"
                        # term_type, tags, translations ëˆ„ë½
                    }
                ]
            },
            selected_languages=["ko"]
        )

        with pytest.raises(ValueError, match="í•„ìˆ˜ í•„ë“œ ëˆ„ë½"):
            await service.generate_markdown_table(request)

    @pytest.mark.asyncio
    async def test_validate_terms_missing_translation(self, service):
        """ë²ˆì—­ ëˆ„ë½ ê²€ì¦ í…ŒìŠ¤íŠ¸"""
        request = MarkdownGenerationRequest(
            terms_data={
                "enhanced_terms": [
                    {
                        "original_term": "Test",
                        "term_type": "person",
                        "tags": ["#test"],
                        "translations": {
                            "ko": "í…ŒìŠ¤íŠ¸"
                            # en ë²ˆì—­ ëˆ„ë½
                        }
                    }
                ]
            },
            selected_languages=["ko", "en"]
        )

        with pytest.raises(ValueError, match="ë²ˆì—­ ëˆ„ë½"):
            await service.generate_markdown_table(request)
```

### í†µí•© í…ŒìŠ¤íŠ¸

#### API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸

```python
"""
ë§ˆí¬ë‹¤ìš´ ìƒì„± API í†µí•© í…ŒìŠ¤íŠ¸
"""

import pytest
from fastapi.testclient import TestClient
from src.main import app


class TestMarkdownAPI:
    """
    ë§ˆí¬ë‹¤ìš´ ìƒì„± API í†µí•© í…ŒìŠ¤íŠ¸
    """

    @pytest.fixture
    def client(self):
        """í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸"""
        return TestClient(app)

    @pytest.fixture
    def valid_payload(self):
        """ìœ íš¨í•œ ìš”ì²­ í˜ì´ë¡œë“œ"""
        return {
            "terms_data": {
                "enhanced_terms": [
                    {
                        "original_term": "United Nations",
                        "term_type": "company",
                        "tags": ["#UN", "#global"],
                        "translations": {
                            "ko": "ìœ ì—”",
                            "en": "United Nations",
                            "ja": "å›½éš›é€£åˆ"
                        }
                    }
                ]
            },
            "selected_languages": ["ko", "en", "ja"]
        }

    def test_generate_markdown_success(self, client, valid_payload):
        """ë§ˆí¬ë‹¤ìš´ ìƒì„± API ì„±ê³µ í…ŒìŠ¤íŠ¸"""
        response = client.post("/api/v1/markdown/generate", json=valid_payload)

        assert response.status_code == 200

        data = response.json()
        assert "markdown_table" in data
        assert data["term_count"] == 1
        assert data["column_count"] == 6  # term + term_type + tags + 3 languages

    def test_generate_markdown_invalid_language(self, client, valid_payload):
        """ì˜ëª»ëœ ì–¸ì–´ ì½”ë“œ í…ŒìŠ¤íŠ¸"""
        valid_payload["selected_languages"] = ["invalid"]

        response = client.post("/api/v1/markdown/generate", json=valid_payload)

        assert response.status_code == 422
        assert "ìœ íš¨í•˜ì§€ ì•Šì€ ì–¸ì–´ ì½”ë“œ" in response.json()["detail"]

    def test_generate_markdown_missing_terms(self, client):
        """ìš©ì–´ ë°ì´í„° ëˆ„ë½ í…ŒìŠ¤íŠ¸"""
        payload = {
            "terms_data": {},  # enhanced_terms ëˆ„ë½
            "selected_languages": ["ko"]
        }

        response = client.post("/api/v1/markdown/generate", json=payload)

        assert response.status_code == 422

    def test_generate_markdown_too_many_languages(self, client, valid_payload):
        """ìµœëŒ€ ì–¸ì–´ ê°œìˆ˜ ì´ˆê³¼ í…ŒìŠ¤íŠ¸"""
        valid_payload["selected_languages"] = [
            "ko", "en", "zh-CN", "zh-TW", "ja",
            "fr", "ru", "it", "vi", "ar", "es", "de"  # 12ê°œ (ì´ˆê³¼)
        ]

        response = client.post("/api/v1/markdown/generate", json=valid_payload)

        assert response.status_code == 422
```

---

## ğŸ“Š ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ì˜ˆì‹œ

### ì…ë ¥ JSON
```json
{
  "enhanced_terms": [
    {
      "original_term": "Naciones Unidas",
      "term_type": "company",
      "tags": ["#ONU", "#global", "#politics"],
      "translations": {
        "ko": "ìœ ì—”",
        "en": "United Nations",
        "ja": "å›½éš›é€£åˆ"
      }
    },
    {
      "original_term": "OTAN",
      "term_type": "company",
      "tags": ["#NATO", "#security"],
      "translations": {
        "ko": "ë¶ëŒ€ì„œì–‘ ì¡°ì•½ ê¸°êµ¬",
        "en": "NATO",
        "ja": "åŒ—å¤§è¥¿æ´‹æ¡ç´„æ©Ÿæ§‹"
      }
    }
  ]
}
```

### ì„ íƒ ì–¸ì–´
- Korean (ko) âœ“
- English (en) âœ“
- Japanese (ja) âœ“

### ìƒì„±ëœ ë§ˆí¬ë‹¤ìš´

```markdown
|term|term_type|tags|ko|en|ja|
|------|----------|------|-----|-----|-----|
|Naciones Unidas|company|#ONU #global #politics|ìœ ì—”|United Nations|å›½éš›é€£åˆ|
|OTAN|company|#NATO #security|ë¶ëŒ€ì„œì–‘ ì¡°ì•½ ê¸°êµ¬|NATO|åŒ—å¤§è¥¿æ´‹æ¡ç´„æ©Ÿæ§‹|
```

### ë Œë”ë§ ê²°ê³¼

|term|term_type|tags|ko|en|ja|
|------|----------|------|-----|-----|-----|
|Naciones Unidas|company|#ONU #global #politics|ìœ ì—”|United Nations|å›½éš›é€£åˆ|
|OTAN|company|#NATO #security|ë¶ëŒ€ì„œì–‘ ì¡°ì•½ ê¸°êµ¬|NATO|åŒ—å¤§è¥¿æ´‹æ¡ç´„æ©Ÿæ§‹|

---

## ğŸš€ ë°°í¬ ë° í†µí•©

### 1. ë¼ìš°í„° ë“±ë¡

**íŒŒì¼**: `src/main.py`ì— ì¶”ê°€

```python
from src.presentation.api.routes import markdown

# ë¼ìš°í„° ë“±ë¡
app.include_router(markdown.router)
```

### 2. Demo í˜ì´ì§€ ë¼ìš°íŠ¸ ì¶”ê°€

**íŒŒì¼**: `src/presentation/api/routes/demo.py`ì— ì¶”ê°€

```python
@router.get(
    "/markdown-table",
    response_class=HTMLResponse,
    status_code=status.HTTP_200_OK,
    summary="ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ë°ëª¨ í˜ì´ì§€",
    description="""
    ìš©ì–´ ì¶”ì¶œ ê²°ê³¼ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ë³€í™˜í•˜ëŠ” ë°ëª¨ í˜ì´ì§€ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

    **ì£¼ìš” ê¸°ëŠ¥:**
    - JSON ë°ì´í„° ì…ë ¥ (textarea ë˜ëŠ” íŒŒì¼ ì—…ë¡œë“œ)
    - 11ê°œ ì–¸ì–´ ì¤‘ ì„ íƒì  ì»¬ëŸ¼ êµ¬ì„±
    - ì„œë²„ APIë¥¼ í†µí•œ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„±
    - í´ë¦½ë³´ë“œ ë³µì‚¬ ë° .md íŒŒì¼ ë‹¤ìš´ë¡œë“œ
    """
)
async def markdown_table_demo() -> HTMLResponse:
    """
    ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„± ë°ëª¨ í˜ì´ì§€ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    """
    html_file = Path("static/markdown-table-demo.html")

    if not html_file.exists():
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail=f"ë°ëª¨ í˜ì´ì§€ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {html_file}"
        )

    try:
        with open(html_file, "r", encoding="utf-8") as f:
            html_content = f.read()
    except Exception as e:
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail=f"ë°ëª¨ í˜ì´ì§€ ë¡œë“œ ì‹¤íŒ¨: {str(e)}"
        )

    return HTMLResponse(content=html_content, status_code=200)
```

### 3. Demo ì¸ë±ìŠ¤ í˜ì´ì§€ ì—…ë°ì´íŠ¸

**íŒŒì¼**: `static/demo-index.html`ì— ìƒˆ ë°ëª¨ ë§í¬ ì¶”ê°€

```html
<div class="demo-card">
    <h3>ğŸ“Š ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ìƒì„±</h3>
    <p>ìš©ì–´ ì¶”ì¶œ ê²°ê³¼ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
    <ul>
        <li>JSON ë°ì´í„° ì…ë ¥</li>
        <li>ë‹¤êµ­ì–´ ì»¬ëŸ¼ ì„ íƒ (11ê°œ ì–¸ì–´)</li>
        <li>ë§ˆí¬ë‹¤ìš´ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ</li>
    </ul>
    <a href="/demo/markdown-table" class="demo-link">ë°ëª¨ ì‹œì‘ â†’</a>
</div>
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ê°œë°œ ë‹¨ê³„
- [ ] DTO í´ë˜ìŠ¤ êµ¬í˜„ (MarkdownGenerationRequest, MarkdownGenerationResponse)
- [ ] ë„ë©”ì¸ ì„œë¹„ìŠ¤ êµ¬í˜„ (MarkdownTableFormatter)
- [ ] ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ êµ¬í˜„ (MarkdownGenerationService)
- [ ] API ë¼ìš°í„° êµ¬í˜„ (markdown.py)
- [ ] ì˜ì¡´ì„± ì£¼ì… ì„¤ì • (dependencies.py)
- [ ] í”„ë¡ íŠ¸ì—”ë“œ HTML í˜ì´ì§€ êµ¬í˜„ (markdown-table-demo.html)
- [ ] Demo ë¼ìš°íŠ¸ ì¶”ê°€ (demo.py)
- [ ] ë¼ìš°í„° ë“±ë¡ (main.py)

### í…ŒìŠ¤íŠ¸ ë‹¨ê³„
- [ ] MarkdownTableFormatter ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ] MarkdownGenerationService ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ] API ì—”ë“œí¬ì¸íŠ¸ í†µí•© í…ŒìŠ¤íŠ¸
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (ìˆ˜ë™)
- [ ] ì–¸ì–´ ì„ íƒ ê²€ì¦ í…ŒìŠ¤íŠ¸
- [ ] ì—ëŸ¬ í•¸ë“¤ë§ í…ŒìŠ¤íŠ¸

### ë¬¸ì„œí™” ë‹¨ê³„
- [ ] API ë¬¸ì„œ ìë™ ìƒì„± í™•ì¸ (Swagger UI)
- [ ] README ì—…ë°ì´íŠ¸
- [ ] ì‚¬ìš© ê°€ì´ë“œ ì‘ì„±

### ë°°í¬ ë‹¨ê³„
- [ ] ë¡œì»¬ í™˜ê²½ í…ŒìŠ¤íŠ¸
- [ ] ìŠ¤í…Œì´ì§• í™˜ê²½ ë°°í¬
- [ ] í”„ë¡œë•ì…˜ í™˜ê²½ ë°°í¬

---

## ğŸ“ êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1: ë°±ì—”ë“œ í•µì‹¬ ê¸°ëŠ¥ (1-2ì¼)
1. DTO í´ë˜ìŠ¤ êµ¬í˜„
2. MarkdownTableFormatter êµ¬í˜„
3. MarkdownGenerationService êµ¬í˜„
4. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±

### Phase 2: API ë ˆì´ì–´ (1ì¼)
1. API ë¼ìš°í„° êµ¬í˜„
2. ì˜ì¡´ì„± ì£¼ì… ì„¤ì •
3. í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±

### Phase 3: í”„ë¡ íŠ¸ì—”ë“œ (1-2ì¼)
1. HTML í˜ì´ì§€ êµ¬í˜„
2. JavaScript ë¡œì§ êµ¬í˜„
3. CSS ìŠ¤íƒ€ì¼ë§
4. ìˆ˜ë™ í…ŒìŠ¤íŠ¸

### Phase 4: í†µí•© ë° ë°°í¬ (1ì¼)
1. Demo ë¼ìš°íŠ¸ ì¶”ê°€
2. ë¼ìš°í„° ë“±ë¡
3. ì „ì²´ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
4. ë¬¸ì„œ ì‘ì„± ë° ë°°í¬

---

## ğŸ¯ ì„±ê³µ ì§€í‘œ

1. **ê¸°ëŠ¥ì„±**: JSON ì…ë ¥ â†’ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ì¶œë ¥ ì •ìƒ ì‘ë™
2. **ìœ íš¨ì„± ê²€ì¦**: ì˜ëª»ëœ ì…ë ¥ì— ëŒ€í•œ ì ì ˆí•œ ì—ëŸ¬ ì²˜ë¦¬
3. **ì‚¬ìš©ì„±**: ì§ê´€ì ì¸ UI/UX, ëª…í™•í•œ ì•ˆë‚´ ë©”ì‹œì§€
4. **ì„±ëŠ¥**: 100ê°œ ìš©ì–´ ê¸°ì¤€ 1ì´ˆ ì´ë‚´ ìƒì„±
5. **í™•ì¥ì„±**: ìƒˆë¡œìš´ ì–¸ì–´ ì¶”ê°€ ìš©ì´í•œ êµ¬ì¡°

---

## ğŸ“š ì°¸ê³  ìë£Œ

- FastAPI ê³µì‹ ë¬¸ì„œ: https://fastapi.tiangolo.com/
- Pydantic ê³µì‹ ë¬¸ì„œ: https://docs.pydantic.dev/
- Markdown í…Œì´ë¸” ìŠ¤í™: https://www.markdownguide.org/extended-syntax/#tables
- Clean Architecture íŒ¨í„´: https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html
