<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ïö©Ïñ¥ Ï∂îÏ∂ú Îç∞Î™® - PX-Plus</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #14B8A6;
            --primary-dark: #0F766E;
            --success: #10B981;
            --error: #EF4444;
            --warning: #F59E0B;
            --bg-light: #F3F4F6;
            --bg-white: #FFFFFF;
            --text-dark: #1F2937;
            --text-gray: #6B7280;
            --border: #E5E7EB;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        header {
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            text-align: center;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .subtitle {
            color: var(--text-gray);
            font-size: 1rem;
        }

        .input-section {
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--text-dark);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
        }

        textarea.form-input {
            min-height: 150px;
            resize: vertical;
            font-family: 'Courier New', monospace;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .checkbox-group input[type="checkbox"] {
            width: 1.25rem;
            height: 1.25rem;
            cursor: pointer;
        }

        .sample-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .btn-sample {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            background: var(--bg-light);
            border: 1px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-sample:hover {
            background: var(--border);
        }

        .btn {
            padding: 0.875rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-container {
            text-align: center;
            margin-top: 1.5rem;
        }

        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            display: none;
        }

        .alert.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--error);
            color: #991B1B;
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid var(--success);
            color: #065F46;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loading {
            text-align: center;
            padding: 3rem;
            display: none;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid var(--border);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-section {
            background: var(--bg-white);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            display: none;
        }

        .results-section.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .json-output {
            background: #1F2937;
            color: #F3F4F6;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: var(--bg-light);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-gray);
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-gray);
            font-size: 0.875rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 1.5rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .results-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç Ïö©Ïñ¥ Ï∂îÏ∂ú Îç∞Î™®</h1>
            <p class="subtitle">GPT-4oÎ•º ÏÇ¨Ïö©Ìïú Í≥†Ïú†Î™ÖÏÇ¨ Î∞è Ï£ºÏöî ÎèÑÎ©îÏù∏ Ï∂îÏ∂ú</p>
        </header>

        <div class="input-section">
            <h2 class="section-title">ÌÖçÏä§Ìä∏ ÏûÖÎ†•</h2>

            <div id="alert" class="alert"></div>

            <form id="extractForm">
                <div class="form-group">
                    <label class="form-label" for="filename">ÌååÏùºÎ™Ö</label>
                    <input type="text" id="filename" class="form-input" 
                           value="test-document.txt" placeholder="ÌååÏùºÎ™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                </div>

                <div class="form-group">
                    <label class="form-label" for="chunkText">
                        ÌÖçÏä§Ìä∏ ÏûÖÎ†•
                        <span style="font-weight: normal; color: var(--text-gray);">(Ï≤≠ÌÅ¨Î°ú Î∂ÑÌï†ÌïòÏó¨ ÏûÖÎ†•)</span>
                    </label>
                    <textarea id="chunkText" class="form-input" 
                              placeholder="Ï∂îÏ∂úÌï† ÌÖçÏä§Ìä∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
                    <div class="sample-buttons">
                        <button type="button" class="btn-sample" onclick="loadSample('korean')">
                            ÏÉòÌîå 1 (ÌïúÍµ≠Ïñ¥)
                        </button>
                        <button type="button" class="btn-sample" onclick="loadSample('english')">
                            ÏÉòÌîå 2 (ÏòÅÏñ¥)
                        </button>
                        <button type="button" class="btn-sample" onclick="loadSample('mixed')">
                            ÏÉòÌîå 3 (ÌòºÌï©)
                        </button>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="checkbox-group">
                            <input type="checkbox" id="useCache" checked>
                            <span>LLM Ï∫êÏã± ÏÇ¨Ïö©</span>
                        </label>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="parallelWorkers">Î≥ëÎ†¨ ÏõåÏª§ Ïàò</label>
                        <input type="number" id="parallelWorkers" class="form-input" 
                               value="3" min="1" max="10">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="maxEntities">ÏµúÎåÄ ÏóîÌã∞Ìã∞ Ïàò</label>
                        <input type="number" id="maxEntities" class="form-input" 
                               value="50" min="1" max="100">
                    </div>
                </div>

                <div class="btn-container">
                    <button type="submit" class="btn btn-primary">
                        <span>üöÄ</span>
                        <span>Ïö©Ïñ¥ Ï∂îÏ∂ú ÏãúÏûë</span>
                    </button>
                </div>
            </form>

            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>GPT-4oÍ∞Ä Ïö©Ïñ¥Î•º Ï∂îÏ∂úÌïòÍ≥† ÏûàÏäµÎãàÎã§...</p>
            </div>
        </div>

        <div id="results" class="results-section">
            <div class="results-header">
                <h2 class="section-title">Ï∂îÏ∂ú Í≤∞Í≥º</h2>
            </div>

            <div class="stats-grid" id="statsGrid"></div>

            <div class="form-group">
                <label class="form-label">JSON ÏùëÎãµ</label>
                <div class="json-output" id="jsonOutput"></div>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2024 PX-Plus - FastAPI + RFS Framework + GPT-4o</p>
    </footer>

    <script>
        // ÏÉòÌîå ÌÖçÏä§Ìä∏
        const samples = {
            korean: `ÌôçÍ∏∏ÎèôÏùÄ Ï°∞ÏÑ†ÏãúÎåÄÏùò Ï†ÑÏÑ§Ï†ÅÏù∏ ÏùòÏ†ÅÏù¥Îã§. ÌÉêÍ¥ÄÏò§Î¶¨Îì§Ïùò Ïû¨Î¨ºÏùÑ ÎπºÏïóÏïÑ Î∞±ÏÑ±Îì§ÏóêÍ≤å ÎÇòÎàÑÏñ¥ Ï£ºÏóàÎã§. Í∑∏Ïùò ÌôúÏïΩÏùÄ ÎØºÏ§ëÎì§ ÏÇ¨Ïù¥ÏóêÏÑú Íµ¨Ï†ÑÎêòÎ©∞ Ï†ÑÌï¥Ï†∏ ÎÇ¥Î†§ÏôîÎã§.

ÏÇºÏÑ±Ï†ÑÏûêÎäî ÎåÄÌïúÎØºÍµ≠Ïùò ÎåÄÌëúÏ†ÅÏù∏ Ï†ÑÏûê Í∏∞ÏóÖÏù¥Îã§. Ïä§ÎßàÌä∏Ìè∞, Î∞òÎèÑÏ≤¥, Í∞ÄÏ†ÑÏ†úÌíà Îì± Îã§ÏñëÌïú Î∂ÑÏïºÏóêÏÑú ÏÑ∏Í≥Ñ ÏãúÏû•ÏùÑ ÏÑ†ÎèÑÌïòÍ≥† ÏûàÎã§. Í∞§Îü≠Ïãú ÏãúÎ¶¨Ï¶àÎäî Ïï†ÌîåÏùò ÏïÑÏù¥Ìè∞Í≥º Í≤ΩÏüÅÌïòÎäî Ï£ºÎ†• Ï†úÌíàÏù¥Îã§.`,

            english: `Apple Inc. is a multinational technology company headquartered in Cupertino, California. Steve Jobs, Steve Wozniak, and Ronald Wayne founded the company in 1976. The iPhone revolutionized the smartphone industry when it was introduced in 2007.

Elon Musk is the CEO of Tesla and SpaceX. Tesla produces electric vehicles and battery energy storage systems. SpaceX focuses on aerospace technology and space transportation.`,

            mixed: `ÌååÏù¥Ïç¨(Python)ÏùÄ Í∑ÄÎèÑ Î∞ò Î°úÏÑ¨(Guido van Rossum)Ïù¥ Í∞úÎ∞úÌïú ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç Ïñ∏Ïñ¥Îã§. DjangoÏôÄ FlaskÎäî ÌååÏù¥Ïç¨ Í∏∞Î∞òÏùò Ïõπ ÌîÑÎ†àÏûÑÏõåÌÅ¨Ïù¥Îã§.

ReactÎäî Î©îÌÉÄ(Meta, Íµ¨ Facebook)ÏóêÏÑú Í∞úÎ∞úÌïú ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏ ÎùºÏù¥Î∏åÎü¨Î¶¨Îã§. Next.jsÎäî VercelÏóêÏÑú ÎßåÎì† React Í∏∞Î∞ò ÌîÑÎ†àÏûÑÏõåÌÅ¨Ïù¥Îã§. TypeScriptÎäî ÎßàÏù¥ÌÅ¨Î°úÏÜåÌîÑÌä∏(Microsoft)Í∞Ä Í∞úÎ∞úÌïú ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏Ïùò ÏÉÅÏúÑÏßëÌï© Ïñ∏Ïñ¥Îã§.`
        };

        // DOM ÏöîÏÜå
        const extractForm = document.getElementById('extractForm');
        const chunkText = document.getElementById('chunkText');
        const filename = document.getElementById('filename');
        const useCache = document.getElementById('useCache');
        const parallelWorkers = document.getElementById('parallelWorkers');
        const maxEntities = document.getElementById('maxEntities');
        const loading = document.getElementById('loading');
        const results = document.getElementById('results');
        const jsonOutput = document.getElementById('jsonOutput');
        const statsGrid = document.getElementById('statsGrid');
        const alert = document.getElementById('alert');

        // Ìèº Ï†úÏ∂ú Ìï∏Îì§Îü¨
        extractForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            await handleExtract();
        });

        // ÏÉòÌîå Î°úÎìú Ìï®Ïàò
        function loadSample(type) {
            chunkText.value = samples[type];
        }

        // ÏïåÎ¶º ÌëúÏãú Ìï®Ïàò
        function showAlert(message, type = 'error') {
            alert.textContent = message;
            alert.className = `alert alert-${type} show`;
            setTimeout(() => {
                alert.classList.remove('show');
            }, 5000);
        }

        // Ïö©Ïñ¥ Ï∂îÏ∂ú Ïã§Ìñâ
        async function handleExtract() {
            const text = chunkText.value.trim();
            const fname = filename.value.trim();

            if (!text) {
                showAlert('ÌÖçÏä§Ìä∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }

            if (!fname) {
                showAlert('ÌååÏùºÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }

            // ÏöîÏ≤≠ Îç∞Ïù¥ÌÑ∞ Íµ¨ÏÑ±
            const requestData = {
                processed_files: [
                    {
                        filename: fname,
                        chunks: [text],
                        metadata: {
                            timestamp: new Date().toISOString()
                        }
                    }
                ],
                use_cache: useCache.checked,
                parallel_workers: parseInt(parallelWorkers.value),
                template_name: "extract_terms.j2",
                max_entities_per_chunk: parseInt(maxEntities.value),
                include_context: true
            };

            // UI ÏÉÅÌÉú Î≥ÄÍ≤Ω
            loading.classList.add('show');
            results.classList.remove('show');
            alert.classList.remove('show');

            try {
                const response = await fetch('/api/v1/extract-terms/process-documents', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || `HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                // Í≤∞Í≥º Î†åÎçîÎßÅ
                renderResults(data);
                showAlert('Ïö©Ïñ¥ Ï∂îÏ∂úÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!', 'success');

            } catch (error) {
                console.error('Ï∂îÏ∂ú Ïã§Ìå®:', error);
                showAlert(error.message || 'Ïö©Ïñ¥ Ï∂îÏ∂ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
            } finally {
                loading.classList.remove('show');
            }
        }

        // Í≤∞Í≥º Î†åÎçîÎßÅ
        function renderResults(data) {
            results.classList.add('show');

            // ÌÜµÍ≥Ñ Î†åÎçîÎßÅ
            const summary = data.summary;
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${summary.total_chunks}</div>
                    <div class="stat-label">Ï¥ù Ï≤≠ÌÅ¨ Ïàò</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${summary.total_entities}</div>
                    <div class="stat-label">Ï∂îÏ∂úÎêú ÏóîÌã∞Ìã∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${(summary.cache_hit_rate * 100).toFixed(1)}%</div>
                    <div class="stat-label">Ï∫êÏãú ÌûàÌä∏Ïú®</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${summary.total_processing_time.toFixed(2)}s</div>
                    <div class="stat-label">Ï≤òÎ¶¨ ÏãúÍ∞Ñ</div>
                </div>
            `;

            // JSON ÏùëÎãµ Î†åÎçîÎßÅ
            jsonOutput.textContent = JSON.stringify(data, null, 2);
        }

        // Ï†ÑÏó≠ Ìï®Ïàò ÎÖ∏Ï∂ú
        window.loadSample = loadSample;
    </script>
</body>
</html>